services:
  byparr:
    image: ghcr.io/thephaseless/byparr:2.1.0
    container_name: byparr
    restart: unless-stopped
    networks:
      - homelab_default
    environment:
      - TZ=Australia/Sydney
    healthcheck:
      test: ["CMD-SHELL", "curl -sf http://localhost:8191/ || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s
    labels:
      - traefik.enable=true
      - traefik.http.routers.byparr.service=byparr
      - traefik.http.routers.byparr.rule=Host(`byparr.tylercash.dev`) && (ClientIP(`10.0.0.0/8`) || ClientIP(`172.19.0.0/24`))
      - traefik.http.routers.byparr.entrypoints=websecure
      - traefik.http.services.byparr.loadbalancer.server.scheme=http
      - traefik.http.services.byparr.loadbalancer.server.port=8191
      - traefik.http.routers.byparr.tls.certresolver=leresolver
      - com.centurylinklabs.watchtower.enable=true

  jellyfin:
    image: lscr.io/linuxserver/jellyfin:10.11.6ubu2404-ls22
    container_name: jellyfin
    restart: unless-stopped
    networks:
      - homelab_default
    devices:
     - /dev/dri/renderD128:/dev/dri/renderD128
    volumes:
      - /hdd/docker/media:/data/media
      - /ssd/fast_storage/docker/jellyfin:/config
    environment:
      - PUID=568
      - PGID=568
      - UMASK=0002
      - TZ=Australia/Sydney
    healthcheck:
      test: ["CMD-SHELL", "curl -sf http://localhost:8096/health || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    labels:
      - traefik.enable=true
      - traefik.http.routers.jellyfin.service=jellyfin
      - traefik.http.routers.jellyfin.rule=Host(`jellyfin.tylercash.dev`) && (ClientIP(`10.0.0.0/8`) || ClientIP(`172.19.0.0/24`))
      - traefik.http.routers.jellyfin.entrypoints=websecure
      - traefik.http.services.jellyfin.loadbalancer.server.scheme=http
      - traefik.http.services.jellyfin.loadbalancer.server.port=8096
      - traefik.http.routers.jellyfin.tls.certresolver=leresolver
      - com.centurylinklabs.watchtower.enable=true

  plex:
    image: lscr.io/linuxserver/plex:1.43.0.10492-121068a07-ls294
    container_name: plex
    hostname: plex
    restart: unless-stopped
    networks:
      - homelab_default
    devices:
     - /dev/dri/renderD128:/dev/dri/renderD128
    volumes:
      - /hdd/docker/media:/data/media
      - /ssd/fast_storage/docker/plex:/config
    environment:
      - PUID=568
      - PGID=568
      - UMASK=0002
      - TZ=Australia/Sydney
      - VERSION=docker
      - ADVERTISE_IP=https://plex.tylercash.dev
    healthcheck:
      test: ["CMD-SHELL", "curl -sf http://localhost:32400/identity || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    labels:
      - traefik.enable=true
      - traefik.http.routers.plex.service=plex
      - traefik.http.routers.plex.rule=Host(`plex.tylercash.dev`)
      - traefik.http.routers.plex.entrypoints=websecure
      - traefik.http.services.plex.loadbalancer.server.scheme=http
      - traefik.http.services.plex.loadbalancer.server.port=32400
      - traefik.http.routers.plex.tls.certresolver=leresolver
      - com.centurylinklabs.watchtower.enable=true

  prowlarr:
    image: lscr.io/linuxserver/prowlarr:2.3.0.5236-ls137
    container_name: prowlarr
    restart: unless-stopped
    networks:
      - homelab_default
    volumes:
      - /ssd/fast_storage/docker/prowlarr:/config
    environment:
      - PUID=568
      - PGID=568
      - TZ=Australia/Sydney
      - DOCKER_MODS=ghcr.io/themepark-dev/theme.park:prowlarr
      - TP_THEME=plex
    healthcheck:
      test: ["CMD-SHELL", "curl -sf http://localhost:9696/ping || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    labels:
      - traefik.enable=true
      - traefik.http.routers.prowlarr.service=prowlarr
      - traefik.http.routers.prowlarr.rule=Host(`prowlarr.tylercash.dev`) && (ClientIP(`10.0.0.0/8`) || ClientIP(`172.19.0.0/24`))
      - traefik.http.routers.prowlarr.entrypoints=websecure
      - traefik.http.services.prowlarr.loadbalancer.server.scheme=http
      - traefik.http.services.prowlarr.loadbalancer.server.port=9696
      - traefik.http.routers.prowlarr.tls.certresolver=leresolver
      - com.centurylinklabs.watchtower.enable=true

  qbittorrent:
    image: lscr.io/linuxserver/qbittorrent:5.1.4-r2-ls442
    container_name: qbittorrent
    restart: unless-stopped
    networks:
      - homelab_default
    volumes:
      - /ssd/fast_storage/docker/qbittorrent:/config
      - /mnt/lvm_striped/download/:/data/download/incomplete
      - /hdd/docker/media/download/complete:/data/download/complete
    environment:
      - PUID=568
      - PGID=568
      - UMASK=0002
      - TZ=Australia/Sydney
      - WEBUI_PORT=8200
      - DOCKER_MODS=ghcr.io/themepark-dev/theme.park:qbittorrent
      - TP_THEME=plex
    healthcheck:
      test: ["CMD-SHELL", "curl -sf http://localhost:8200/ || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    labels:
      - traefik.enable=true
      - traefik.http.routers.qbittorrent.service=qbittorrent
      - traefik.http.routers.qbittorrent.rule=Host(`qbittorrent.tylercash.dev`) && (ClientIP(`10.0.0.0/8`) || ClientIP(`172.19.0.0/24`))
      - traefik.http.routers.qbittorrent.entrypoints=websecure
      - traefik.http.services.qbittorrent.loadbalancer.server.scheme=http
      - traefik.http.services.qbittorrent.loadbalancer.server.port=8200
      - traefik.http.routers.qbittorrent.tls.certresolver=leresolver
      - com.centurylinklabs.watchtower.enable=true

  radarr:
    image: lscr.io/linuxserver/radarr:6.0.4.10291-ls293
    container_name: radarr
    restart: unless-stopped
    networks:
      - homelab_default
    volumes:
      - /hdd/docker/media:/data
      - /ssd/fast_storage/docker/radarr:/config
    environment:
      - PUID=568
      - PGID=568
      - TZ=Australia/Sydney
      - DOCKER_MODS=ghcr.io/themepark-dev/theme.park:radarr
      - TP_THEME=plex
    healthcheck:
      test: ["CMD-SHELL", "curl -sf http://localhost:7878/ping || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    labels:
      - traefik.enable=true
      - traefik.http.routers.radarr.service=radarr
      - traefik.http.routers.radarr.rule=Host(`radarr.tylercash.dev`) && (ClientIP(`10.0.0.0/8`) || ClientIP(`172.19.0.0/24`))
      - traefik.http.routers.radarr.entrypoints=websecure
      - traefik.http.services.radarr.loadbalancer.server.scheme=http
      - traefik.http.services.radarr.loadbalancer.server.port=7878
      - traefik.http.routers.radarr.tls.certresolver=leresolver
      - com.centurylinklabs.watchtower.enable=true

  sonarr:
    image: lscr.io/linuxserver/sonarr:4.0.16.2944-ls303
    container_name: sonarr
    restart: unless-stopped
    networks:
      - homelab_default
    volumes:
      - /hdd/docker/media:/data
      - /ssd/fast_storage/docker/sonarr:/config
    environment:
      - PUID=568
      - PGID=568
      - TZ=Australia/Sydney
      - DOCKER_MODS=ghcr.io/themepark-dev/theme.park:sonarr
      - TP_THEME=plex
    healthcheck:
      test: ["CMD-SHELL", "curl -sf http://localhost:8989/ping || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    labels:
      - traefik.enable=true
      - traefik.http.routers.sonarr.service=sonarr
      - traefik.http.routers.sonarr.rule=Host(`sonarr.tylercash.dev`) && (ClientIP(`10.0.0.0/8`) || ClientIP(`172.19.0.0/24`))
      - traefik.http.services.sonarr.loadbalancer.server.port=8989
      - traefik.http.routers.sonarr.tls.certresolver=leresolver
      - com.centurylinklabs.watchtower.enable=true

  profilarr:
    image: santiagosayshey/profilarr:v1.1.4
    container_name: profilarr
    networks:
      - homelab_default
    volumes:
      - /ssd/fast_storage/docker/profilarr:/config
    environment:
      - PUID=568
      - PGID=568
      - TZ=Australia/Sydney
    restart: unless-stopped
    healthcheck:
      test: ["CMD-SHELL", "curl -sf http://localhost:6868/ || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    labels:
      - traefik.enable=true
      - traefik.http.routers.profilarr.service=profilarr
      - traefik.http.routers.profilarr.rule=Host(`profilarr.tylercash.dev`) && (ClientIP(`10.0.0.0/8`) || ClientIP(`172.19.0.0/24`))
      - traefik.http.routers.profilarr.entrypoints=websecure
      - traefik.http.routers.profilarr.tls.certresolver=leresolver
      - traefik.http.services.profilarr.loadbalancer.server.port=6868
      - com.centurylinklabs.watchtower.enable=true


networks:
  homelab_default:
    external: true
